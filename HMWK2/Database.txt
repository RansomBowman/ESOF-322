/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package esof.hmwk.pkg2;

import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;
import java.util.Scanner;

/**
 *
 * @author ranso
 */
public class Database {
    String dataType;
    
    public void writeFile(String storType) throws IOException{
        Scanner in = new Scanner(System.in);
        System.out.print("Input info for storage: ");
        String input = in.next();
        
        BufferedWriter buff = new BufferedWriter(new FileWriter("C:\\Users\\ranso\\Documents\\NetBeansProjects\\ESOF HMWK 2\\" + storType +".txt", true));
    
        buff.newLine();   
        buff.write(input);
        buff.close();
    }
    public void Store(int def) throws IOException{
        if(def == 1){
            tableStore();
        }else if(def == 2){
            documentStore();
        }else if(def == 3){
            nodeStore();
        }
        Scanner in = new Scanner(System.in);
        System.out.print("Change storage method from default (yes or no): ");
        String inp = in.next();
        if(inp.equals("yes")){
            def = setStoreStrategy();
            if(def == 1){
                tableStore();
            }else if(def == 2){
                documentStore();
            }else if(def == 3){
                nodeStore();
            }
        }


    }
    
    public void tableStore() throws IOException{
        dataType= "relational";
        writeFile(dataType);
    }
    
    public void documentStore() throws IOException{
        dataType= "nosql";
        writeFile(dataType);
    }
    
    public void nodeStore() throws IOException{
        dataType= "graph";
        writeFile(dataType);
    }
    
    public int setStoreStrategy()throws IOException{
        Scanner in = new Scanner(System.in);
        System.out.print("Input storage method number (1. Table 2. Document 3. Node): ");
        int inNum = in.nextInt();
            if(inNum == 1){
                System.out.println("Table Store");
                
                return 1;
            }else if(inNum == 2){
                System.out.println("Document Store");
                return 2;
            }else if(inNum == 3){
                System.out.println("Node Store");
                return 3;
            }else{
                return 0;
            }
        
    }
}
